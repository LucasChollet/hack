<!doctype html>
<html lang="en">
<meta charset="utf-8">
<style>
img {
  max-width: 100%;
  height: auto;
}
</style>
<form>
  <label>
      Choose an image file from your computer, or drop or paste an image:<br>
      <input type="file" id="file" name="file" accept="image/*">
  </label>
</form>
<div></div>

<script>
'use strict';

window.addEventListener('paste', event => {
  let file_input = document.querySelector('#file');
  file_input.files = event.clipboardData.files;
  file_input.dispatchEvent(new Event('change'))
});

// https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API
window.addEventListener('dragover', event => {
  event.preventDefault();
  event.dataTransfer.dropEffect = 'copy';
});
window.addEventListener('drop', event => {
  event.preventDefault();
  let file_input = document.querySelector('#file');
  file_input.files = event.dataTransfer.files;
  file_input.dispatchEvent(new Event('change'))
});

// https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications
document.querySelector('#file').addEventListener('change', (event) => {
  const div = document.querySelector('div');
  div.textContent = '';

  // No `multiple` attribute on the file input, so there's exactly one file.
  const file = event.target.files[0];
  if (!file.type.startsWith('image/')) {
    const err = `Error: expected image, got ${file.type}. Try again.`;
    div.textContent = err;
    return;
  }

  const img = document.createElement('img');
  div.appendChild(img);

  const reader = new FileReader();
  reader.onload = (e) => { img.src = e.target.result; };
  reader.readAsDataURL(file);
});
</script>
